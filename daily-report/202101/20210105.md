# 2021/01/05

「XXのときがある」みたいなコメントがあるが、いつどんなときにそれが発生するかわからないと保守しているときに直して良いものか判断できず放置されがち

例：明示的に型指定されている引数なのに型判定処理が記述されている

```tsx
function(a: number){
　// 画面からstringでaが渡されてくる場合がある
	const b = typeof a === 'number' ? a ? a : a.toNumber();
	// 続きの処理あれこれ
　...
}
```

これを見たときの印象

- `a` は引数で `number` 指定されているのだから、一時変数 `b` の処理は不要では
- でもコメントに `画面からstringでaが渡されてくる場合がある` と記述されているな
- どんなときに発生するのだろう？
- `git blame` で過去コミットやPull Requestにヒントがないか漁るか…（めっちゃ時間がかかる）

大体こういうときはPull Requestやコミットメッセージがない or `init` みたいな内容がない状態とセットになっているパターンが多い。

どこで例外が発生するか突き止めるために関連処理を全部追いかける必要がある。時間かかるしつらい。

まだわかる例

```tsx
function(a: number){
　// XXの仕様でstring型のパラメータが混入する場合がある issue#xxx
	const b = typeof a === 'number' ? a ? a : a.toNumber();
	// 続きの処理あれこれ
　...
}
```

発生パターンがわかるようになってほしい。

「XXのパターンで発生した」みたいにコメントしづらい場合もある。そのときは作業issueやPull Request、関連チケットに記録を残してリンクを貼る・番号を記述するなどしてほしい。

後から追いかけることができるので。

チーム内の役割が曖昧だと、特定個人が自助努力素敵ボランティアしてない領域は玉落ちするなと思った。連携サービスでこれしてな、ってのが半年前に出てるのに誰も気づいてない（見てない）からね…。期限近くなって慌てて対応するとかめっちゃ恥ずかしいやつじゃん…。

でもこういうのは気づける人が対応し続けると永遠にその人任せになってしまうんだよなぁ…。だからチーミングは大事だとおもうんだどな。気づける人は大体優秀で、そういう人は他のところに行っちゃうんだよなあ…。

TypeScriptなんだから汎化して `any` typeを乱用してたらあんまり恩恵ないようなと思ってしまった。同じような部品の使い回しでも関数だけ外からはめ込める方が便利だよねえ。扱うデータ違うなら別にするべきだよなと思ってしまった。変更時に影響範囲が広すぎる。

次の機能開発で `Surrogate-Key` の話が出てくるんだけど、これFastlyだけの話かと思ってたらW3C定義のリクエストヘッダーだった。CDN扱う人、リクエストヘッダーについての理解が求められる…。2021年はこの辺の知識を得ることに注力していくと仕事にも使えるし、Web全般の知識で応用も効くのでいい感じだなと思った。基礎技術がナンタラ感がある。

[https://huyukiitoichi.hatenadiary.jp/entry/2021/01/04/142609](https://huyukiitoichi.hatenadiary.jp/entry/2021/01/04/142609)

↑面白そうだった。

めっちゃ真剣にやってると音楽なしでも意外といけるなと思った。でもまあ飽きちゃいますね。

PR出しまくってるとストレスかな〜とか気使っちゃう…。1つ終わるまで待つべきなのだろうか。でもタスクうわ〜てなったら「順番どうしましょ、溢れます」みたいに主張して調整するのは作業がわでやるべきなんだろなと思ってしまうが…うーん。まあissueに「いついつまでに終わりたいね」とか書いてあるし、いい感じに自分で計画引いて進めて！なんでしょうね。

Notionで雑観をメモ取りしながら仕事するといい感じかもしれない。家だからこそできることなのでしばらくやっていきたい（緊急事態宣言でる = しばらくは家なので）。でもネットサーフィンしちゃってサボりになりかけるのはやめたい。まあ集中できなきゃ何しても一緒だけど…。

個人利用のMacbook AirをBig SurにアプデしてVSCode開いたらフォントに色がつかなくなった。[issue](https://github.com/adobe-fonts/source-code-pro/issues/250)はもう出ていて、Source Han Code側の問題っぽい。

日本語フォントもある[source-han-code-jp](https://github.com/adobe-fonts/source-han-code-jp/blob/master/README-JP.md)を使っていたのでアップデートした。リリースノートも出てました。

アップデート手順

1. Font bookで源ノ角ゴシック JPを削除
2. [Releases](https://github.com/adobe-fonts/source-han-code-jp/releases/tag/2.012R) からOTF・OTCをダウンロード
    - Source Codeはフォントではないので注意
3. 解凍してFont bookを使ってインストール [参考](https://support.apple.com/ja-jp/HT201749)
4. VSCodeで色が戻ったか確認

Twitterで検索したらissueすぐ見つけられたのでやっぱりTwitterは最高だなと思いました。

全体的に動作が重たい感じなのでMac miniはしばらく様子見しようと思った。開発や原稿やるぞ！のときしか使ってないので。